/**
 * ControlGrid Component Styles
 */

.maplibre-gl-control-grid {
  position: relative;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 4px;
  box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
  padding: 10px;
  color: #1a1a1a;
}

/* Collapsed: single square wrench button, no grid visible */
.maplibre-gl-control-grid--collapsed {
  padding: 0;
}

.maplibre-gl-control-grid--collapsed .maplibre-gl-control-grid-content {
  display: none !important;
}

.maplibre-gl-control-grid-header {
  user-select: none;
  color: #1a1a1a;
}

.maplibre-gl-control-grid-title {
  color: #1a1a1a;
}

.maplibre-gl-control-grid-toggle {
  color: #1a1a1a;
  transition: color 0.15s ease;
}

.maplibre-gl-control-grid-toggle:hover {
  color: #0078d7;
}

/* Collapsed state: wrench icon only (same size as Terrain/Globe/Navigation icons) */
.maplibre-gl-control-grid-wrench {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  color: #1a1a1a;
  transition: color 0.15s ease;
}

.maplibre-gl-control-grid-wrench svg {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

.maplibre-gl-control-grid-wrench:hover {
  color: #0078d7;
}

.maplibre-gl-control-grid-content {
  /* Grid layout applied inline for dynamic rows/columns */
}

.maplibre-gl-control-grid-content > * {
  min-width: 0;
  min-height: 0;
}

/* Number inputs in header */
.maplibre-gl-control-grid input[type="number"] {
  border: 1px solid rgba(0, 0, 0, 0.2);
  border-radius: 2px;
  font-size: inherit;
  background: rgba(255, 255, 255, 0.9);
  color: #1a1a1a;
}

.maplibre-gl-control-grid input[type="number"]:focus {
  outline: none;
  border-color: #0078d7;
}

/* Floating panel for expanded child controls */
.maplibre-gl-control-grid-floating-panel {
  position: absolute;
  top: 100%;
  right: 0;
  margin-top: 10px;
  z-index: 10;
}

/* Strip default MapLibre vertical margins inside the floating panel
   so internal and external panels have consistent spacing.
   Keep horizontal margins for right-side padding from map edge. */
.maplibre-gl-control-grid-floating-panel > .maplibregl-ctrl {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
}

/* ViewState panel uses top:100%/right:0 absolute positioning which breaks
   inside the floating panel. Reset to static so it flows normally;
   the explicit inline width (280px) is preserved. */
.maplibre-gl-control-grid-floating-panel .maplibre-gl-view-state-panel {
  position: static !important;
  top: auto !important;
  right: auto !important;
  margin-top: 0 !important;
}

/* Override minimap panel positioning inside the floating panel so it flows
   below the button instead of using bottom:36px (which would go behind the grid). */
.maplibre-gl-control-grid-floating-panel .maplibre-gl-minimap-control .minimap-panel {
  position: relative;
  bottom: auto;
  left: auto;
  margin-top: 0;
}

/* Preserve right margin for minimap control inside the floating panel.
   _hideFloatingButton zeroes marginRight for controls without maplibregl-ctrl-group,
   but the minimap needs its margin to match other controls' right padding. */
.maplibre-gl-control-grid-floating-panel .maplibre-gl-minimap-control {
  margin-right: 8px !important;
}


/* Relocated external panel: strip absolute positioning when moved into floating panel */
.maplibre-gl-control-grid-relocated {
  position: static !important;
  top: auto !important;
  bottom: auto !important;
  left: auto !important;
  right: auto !important;
  z-index: auto !important;
}

/* StreetView panel depends on flex layout; forcing block causes sizing glitches
   (Google letterbox area / Mapillary black canvas) when relocated into floating panel. */
.maplibre-gl-control-grid-relocated.streetview-panel {
  display: flex !important;
  flex-direction: column !important;
}

/* Planetary Computer panel uses flex-column layout for scrollable content;
   preserve it when relocated so overflow-y on .pc-control-content works. */
.maplibre-gl-control-grid-relocated.pc-control-panel {
  display: flex !important;
  flex-direction: column !important;
}

/* Placeholder icon in grid when a child is floating */
.maplibre-gl-control-grid-placeholder--active {
  outline: 2px solid #0078d7;
  outline-offset: -2px;
  border-radius: 4px;
  cursor: pointer;
}

/* Dark mode */
@media (prefers-color-scheme: dark) {
  .maplibre-gl-control-grid {
    background: rgba(40, 40, 40, 0.9);
    color: #e0e0e0;
  }

  .maplibre-gl-control-grid input[type="number"] {
    border-color: rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.1);
    color: #e0e0e0;
  }

  .maplibre-gl-control-grid-toggle:hover,
  .maplibre-gl-control-grid-wrench:hover {
    color: #58a6ff;
  }

  .maplibre-gl-control-grid-wrench {
    color: #e8e8e8;
  }

  .maplibre-gl-control-grid-title,
  .maplibre-gl-control-grid-toggle {
    color: #e8e8e8;
  }

  /* Fix only the four built-in icon buttons with inconsistent dark-mode styling */
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-globe,
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-fullscreen,
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-compass,
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-terrain {
    background: #fff;
    border-color: rgba(0, 0, 0, 0.2);
    color: #1a1a1a;
  }

  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-globe .maplibregl-ctrl-icon,
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-fullscreen .maplibregl-ctrl-icon,
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-compass .maplibregl-ctrl-icon,
  .maplibre-gl-control-grid .maplibregl-ctrl button.maplibregl-ctrl-terrain .maplibregl-ctrl-icon {
    filter: none;
  }

  .maplibre-gl-control-grid-placeholder--active {
    outline-color: #58a6ff;
  }
}
